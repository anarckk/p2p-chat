import{P as N}from"./PeerHttpUtil-BdqDL09T.js";import{d as P,o as F,a as H,k as I,c as e,w as t,r as i,e as o,f as v,h as _,t as c,g as h,b as z,F as E}from"./index-Dh4fjBfC.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logger-CUkP4sI-.js";const L={class:"container"},$={class:"messages-container"},j=P({__name:"TestView",setup(q){const m=i(""),d=i(""),y=i("连接中..."),b=i([]);let l=null;F(()=>{l=new N,l.on("open",n=>{y.value=n}),l.on("message",n=>{u(n.from,n.data)})}),H(()=>{l&&l.destroy()});function k(){const n=m.value.trim(),a=d.value.trim();if(!n||!a)return;const r=l.getId()||"me",p={id:`msg_${Date.now()}`,from:r,to:n,content:a,timestamp:Date.now(),status:"sending",type:"text"};l.sendMessage(n,p).then(()=>{u("我",a),d.value=""}).catch(f=>{u("系统","发送失败: "+f.message,!0)})}function u(n,a,r=!1){b.value.push({from:n,content:a,time:new Date().toLocaleTimeString(),isSystem:r})}return(n,a)=>{const r=o("a-typography-text"),p=o("a-descriptions-item"),f=o("a-descriptions"),w=o("a-divider"),D=o("a-input"),g=o("a-form-item"),C=o("a-textarea"),M=o("a-button"),V=o("a-form"),B=o("a-typography-title"),x=o("a-tag"),S=o("a-list-item"),T=o("a-list"),U=o("a-card");return v(),I("div",L,[e(U,{title:"PeerJS 测试",bordered:!1},{default:t(()=>[e(f,{bordered:"",column:1},{default:t(()=>[e(p,{label:"我的 ID"},{default:t(()=>[e(r,{copyable:""},{default:t(()=>[_(c(y.value),1)]),_:1})]),_:1})]),_:1}),e(w),e(V,{layout:"vertical"},{default:t(()=>[e(g,{label:"对方 ID"},{default:t(()=>[e(D,{value:m.value,"onUpdate:value":a[0]||(a[0]=s=>m.value=s),placeholder:"粘贴对方的 ID"},null,8,["value"])]),_:1}),e(g,{label:"消息内容"},{default:t(()=>[e(C,{value:d.value,"onUpdate:value":a[1]||(a[1]=s=>d.value=s),rows:3,placeholder:"输入要发送的消息"},null,8,["value"])]),_:1}),e(g,null,{default:t(()=>[e(M,{type:"primary",onClick:k},{default:t(()=>[...a[2]||(a[2]=[_("发送消息",-1)])]),_:1})]),_:1})]),_:1}),e(w),e(B,{level:5},{default:t(()=>[...a[3]||(a[3]=[_("消息记录",-1)])]),_:1}),h("div",$,[e(T,{"data-source":b.value,size:"small"},{renderItem:t(({item:s})=>[e(S,null,{default:t(()=>[e(r,{type:"secondary"},{default:t(()=>[_("["+c(s.time)+"]",1)]),_:2},1024),s.isSystem?(v(),z(x,{key:0,color:"warning"},{default:t(()=>[_(c(s.content),1)]),_:2},1024)):(v(),I(E,{key:1},[e(x,{color:"blue"},{default:t(()=>[_(c(s.from),1)]),_:2},1024),h("span",null,c(s.content),1)],64))]),_:2},1024)]),_:1},8,["data-source"])])]),_:1})])}}}),Q=J(j,[["__scopeId","data-v-1565710c"]]);export{Q as default};
